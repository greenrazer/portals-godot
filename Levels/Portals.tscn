[gd_scene load_steps=22 format=2]

[ext_resource path="res://scripts/main.gd" type="Script" id=1]
[ext_resource path="res://scripts/steve.gd" type="Script" id=2]
[ext_resource path="res://scripts/portal_pair.gd" type="Script" id=3]
[ext_resource path="res://shaders/viewport_render.shader" type="Shader" id=4]
[ext_resource path="res://scripts/portal.gd" type="Script" id=5]

[sub_resource type="BoxShape" id=1]

[sub_resource type="SpatialMaterial" id=2]
albedo_color = Color( 0.913725, 0.486275, 0.317647, 1 )

[sub_resource type="CubeMesh" id=3]
material = SubResource( 2 )

[sub_resource type="SpatialMaterial" id=4]
albedo_color = Color( 0.12549, 0.654902, 0.105882, 1 )

[sub_resource type="CubeMesh" id=5]
material = SubResource( 4 )

[sub_resource type="BoxShape" id=6]

[sub_resource type="CubeMesh" id=7]

[sub_resource type="BoxShape" id=20]

[sub_resource type="CubeMesh" id=21]

[sub_resource type="CapsuleShape" id=14]
radius = 0.6

[sub_resource type="CapsuleMesh" id=19]
radius = 0.6

[sub_resource type="BoxShape" id=8]

[sub_resource type="ShaderMaterial" id=9]
shader = ExtResource( 4 )

[sub_resource type="CubeMesh" id=11]

[sub_resource type="ShaderMaterial" id=15]
shader = ExtResource( 4 )

[sub_resource type="CubeMesh" id=17]

[node name="Main" type="Spatial"]
script = ExtResource( 1 )

[node name="Scene" type="Spatial" parent="."]

[node name="Floor 1" type="Spatial" parent="Scene"]
transform = Transform( 13.9109, 0, 0, 0, 0.131421, 0, 0, 0, 25.6974, -17.1266, -0.131, 0 )

[node name="StaticBody" type="StaticBody" parent="Scene/Floor 1"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Floor 1/StaticBody"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Floor 1/StaticBody/CollisionShape"]
mesh = SubResource( 3 )
material/0 = null

[node name="Floor 2" type="Spatial" parent="Scene"]
transform = Transform( 13.9109, 0, 0, 0, 0.131421, 0, 0, 0, 25.6974, 15.9332, -0.131, 0 )

[node name="StaticBody" type="StaticBody" parent="Scene/Floor 2"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Floor 2/StaticBody"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Floor 2/StaticBody/CollisionShape"]
mesh = SubResource( 5 )
material/0 = null

[node name="Ramp1" type="Spatial" parent="Scene"]
transform = Transform( 2.59745, 0, 0, 0, 0.0885348, 0.713321, 0, -0.0156206, 4.04297, 8.34234, 0.335355, 3.71824 )

[node name="StaticBody" type="StaticBody" parent="Scene/Ramp1"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Ramp1/StaticBody"]
shape = SubResource( 6 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Ramp1/StaticBody/CollisionShape"]
mesh = SubResource( 7 )
material/0 = null

[node name="Ramp2" type="Spatial" parent="Scene"]
transform = Transform( -2.2837, 0.0317242, -1.3142, 0, 0.0604043, 3.04068, 1.23752, 0.0585432, -2.42519, -15.2902, 2.31068, 15.1331 )

[node name="StaticBody" type="StaticBody" parent="Scene/Ramp2"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Ramp2/StaticBody"]
shape = SubResource( 6 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Ramp2/StaticBody/CollisionShape"]
mesh = SubResource( 7 )
material/0 = null

[node name="Box" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -11.6539, 0.6, 0 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box/StaticBody/CollisionShape"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 )
mesh = SubResource( 21 )
material/0 = null

[node name="Box2" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 19.3004, 0.6, 0 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box2"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box2/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box2/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Box3" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -22.7931, 0.6, -11.7819 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box3"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box3/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box3/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Box4" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -17.8661, 0.6, 9.1042 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box4"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box4/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box4/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Box5" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 8.05405, 0.6, -20.1363 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box5"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box5/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box5/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Box6" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -9.94012, 0.6, 20.8861 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box6"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box6/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box6/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Box7" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.66262, 0.6, -5.67674 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box7"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box7/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box7/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Box8" type="Spatial" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 19.9431, 0.6, -9.42552 )

[node name="StaticBody" type="StaticBody" parent="Scene/Box8"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Box8/StaticBody"]
transform = Transform( 0.6, 0, 0, 0, 0.6, 0, 0, 0, 0.6, 0, 0, 0 )
shape = SubResource( 20 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Box8/StaticBody/CollisionShape"]
mesh = SubResource( 21 )
material/0 = null

[node name="Steve" type="KinematicBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.54277, 4.30587, 20.7111 )
script = ExtResource( 2 )

[node name="Collider" type="CollisionShape" parent="Steve"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0 )
shape = SubResource( 14 )

[node name="MeshInstance" type="MeshInstance" parent="Steve/Collider"]
mesh = SubResource( 19 )
material/0 = null

[node name="Head" type="Spatial" parent="Steve"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.463354, 0 )

[node name="Camera" type="Camera" parent="Steve/Head"]
current = true

[node name="DownRay" type="RayCast" parent="Steve"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.662256, 0 )
enabled = true

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( 0.562204, -0.424236, -0.709894, 0.765568, -0.0576772, 0.640764, -0.31278, -0.903713, 0.292355, -34.5488, 20.5349, 6.53633 )
light_color = Color( 1, 0.992157, 0.862745, 1 )
shadow_enabled = true

[node name="Portals" type="Spatial" parent="."]

[node name="PortalPair1" type="Spatial" parent="Portals"]
script = ExtResource( 3 )

[node name="PortalA" type="Spatial" parent="Portals/PortalPair1"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -10.666, 2, 3.37379 )
script = ExtResource( 5 )

[node name="Viewport" type="Viewport" parent="Portals/PortalPair1/PortalA"]
keep_3d_linear = true
shadow_atlas_size = 4

[node name="Camera" type="Camera" parent="Portals/PortalPair1/PortalA/Viewport"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 )
cull_mask = 1048569
current = true

[node name="Shape" type="Spatial" parent="Portals/PortalPair1/PortalA"]
transform = Transform( 1.5, 0, 0, 0, 2, 0, 0, 0, 0.03, 0, 0, 0 )

[node name="Area" type="Area" parent="Portals/PortalPair1/PortalA/Shape"]

[node name="CollisionShape" type="CollisionShape" parent="Portals/PortalPair1/PortalA/Shape/Area"]
shape = SubResource( 8 )

[node name="Outside" type="MeshInstance" parent="Portals/PortalPair1/PortalA/Shape"]
transform = Transform( 1, 0, 0, 0, 0.999, 0, 0, 0, 1, 0, 0, 0 )
layers = 2
material_override = SubResource( 9 )
cast_shadow = 0
mesh = SubResource( 11 )
material/0 = null

[node name="PortalB" type="Spatial" parent="Portals/PortalPair1"]
transform = Transform( -1, 0, -3.25841e-07, 0, 1, 0, 3.25841e-07, 0, -1, 8.3419, 2, -12.9615 )
script = ExtResource( 5 )

[node name="Viewport" type="Viewport" parent="Portals/PortalPair1/PortalB"]
keep_3d_linear = true
shadow_atlas_size = 4

[node name="Camera" type="Camera" parent="Portals/PortalPair1/PortalB/Viewport"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 )
cull_mask = 1048569
current = true

[node name="Shape" type="Spatial" parent="Portals/PortalPair1/PortalB"]
transform = Transform( 1.5, 0, 0, 0, 2, 0, 0, 0, 0.03, 0, 0, 0 )

[node name="Area" type="Area" parent="Portals/PortalPair1/PortalB/Shape"]

[node name="CollisionShape" type="CollisionShape" parent="Portals/PortalPair1/PortalB/Shape/Area"]
shape = SubResource( 8 )

[node name="Outside" type="MeshInstance" parent="Portals/PortalPair1/PortalB/Shape"]
transform = Transform( 1, 0, 0, 0, 0.999, 0, 0, 0, 1, 0, 0, 0 )
layers = 4
material_override = SubResource( 15 )
cast_shadow = 0
mesh = SubResource( 17 )
material/0 = null
[connection signal="body_entered" from="Portals/PortalPair1/PortalA/Shape/Area" to="Portals/PortalPair1/PortalA" method="_on_Area_body_entered"]
[connection signal="body_exited" from="Portals/PortalPair1/PortalA/Shape/Area" to="Portals/PortalPair1/PortalA" method="_on_Area_body_exited"]
[connection signal="body_entered" from="Portals/PortalPair1/PortalB/Shape/Area" to="Portals/PortalPair1/PortalB" method="_on_Area_body_entered"]
[connection signal="body_exited" from="Portals/PortalPair1/PortalB/Shape/Area" to="Portals/PortalPair1/PortalB" method="_on_Area_body_exited"]
