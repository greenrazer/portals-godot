[gd_scene load_steps=22 format=2]

[ext_resource path="res://scripts/main.gd" type="Script" id=1]
[ext_resource path="res://scripts/steve.gd" type="Script" id=2]
[ext_resource path="res://scripts/portal_pair.gd" type="Script" id=3]
[ext_resource path="res://shaders/viewport_render.shader" type="Shader" id=4]

[sub_resource type="BoxShape" id=1]

[sub_resource type="SpatialMaterial" id=2]
albedo_color = Color( 0.913725, 0.486275, 0.317647, 1 )

[sub_resource type="CubeMesh" id=3]
material = SubResource( 2 )

[sub_resource type="SpatialMaterial" id=4]
albedo_color = Color( 0.12549, 0.654902, 0.105882, 1 )

[sub_resource type="CubeMesh" id=5]
material = SubResource( 4 )

[sub_resource type="BoxShape" id=6]

[sub_resource type="CubeMesh" id=7]

[sub_resource type="ShaderMaterial" id=9]
shader = ExtResource( 4 )

[sub_resource type="CubeMesh" id=10]
flip_faces = true

[sub_resource type="CubeMesh" id=11]

[sub_resource type="PlaneMesh" id=12]

[sub_resource type="BoxShape" id=8]

[sub_resource type="ShaderMaterial" id=15]
shader = ExtResource( 4 )

[sub_resource type="CubeMesh" id=16]
flip_faces = true

[sub_resource type="CubeMesh" id=17]

[sub_resource type="PlaneMesh" id=18]

[sub_resource type="CapsuleShape" id=14]
radius = 0.6

[node name="Main" type="Spatial"]
script = ExtResource( 1 )

[node name="Scene" type="Spatial" parent="."]

[node name="Floor 1" type="Spatial" parent="Scene"]
transform = Transform( 13.9109, 0, 0, 0, 0.131421, 0, 0, 0, 25.6974, -17.1266, -0.131, 0 )

[node name="StaticBody" type="StaticBody" parent="Scene/Floor 1"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Floor 1/StaticBody"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Floor 1/StaticBody/CollisionShape"]
mesh = SubResource( 3 )
material/0 = null

[node name="Floor 2" type="Spatial" parent="Scene"]
transform = Transform( 13.9109, 0, 0, 0, 0.131421, 0, 0, 0, 25.6974, 15.9332, -0.131, 0 )

[node name="StaticBody" type="StaticBody" parent="Scene/Floor 2"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Floor 2/StaticBody"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Floor 2/StaticBody/CollisionShape"]
mesh = SubResource( 5 )
material/0 = null

[node name="Ramp1" type="Spatial" parent="Scene"]
transform = Transform( 2.59745, 0, 0, 0, 0.0885348, 0.713321, 0, -0.0156206, 4.04297, 8.34234, 0.335355, 3.71824 )

[node name="StaticBody" type="StaticBody" parent="Scene/Ramp1"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Ramp1/StaticBody"]
shape = SubResource( 6 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Ramp1/StaticBody/CollisionShape"]
mesh = SubResource( 7 )
material/0 = null

[node name="Ramp2" type="Spatial" parent="Scene"]
transform = Transform( -2.2837, 0.0317242, -1.3142, 0, 0.0604043, 3.04068, 1.23752, 0.0585432, -2.42519, -15.2902, 2.31068, 15.1331 )

[node name="StaticBody" type="StaticBody" parent="Scene/Ramp2"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Ramp2/StaticBody"]
shape = SubResource( 6 )

[node name="MeshInstance" type="MeshInstance" parent="Scene/Ramp2/StaticBody/CollisionShape"]
mesh = SubResource( 7 )
material/0 = null

[node name="Portals" type="Spatial" parent="Scene"]

[node name="PortalPair1" type="Spatial" parent="Scene/Portals"]
script = ExtResource( 3 )

[node name="PortalA" type="Spatial" parent="Scene/Portals/PortalPair1"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -10.666, 2, 9.00788 )

[node name="Viewport" type="Viewport" parent="Scene/Portals/PortalPair1/PortalA"]
keep_3d_linear = true

[node name="Camera" type="Camera" parent="Scene/Portals/PortalPair1/PortalA/Viewport"]
transform = Transform( -0.557333, -0.186473, 0.809079, -0.105783, 0.98246, 0.153564, -0.823523, 6.13572e-09, -0.567283, -10.666, 2.85573, 11.8936 )
current = true

[node name="Shape" type="Spatial" parent="Scene/Portals/PortalPair1/PortalA"]
transform = Transform( 1.5, 0, 0, 0, 2, 0, 0, 0, 0.1, 0, 0, 0 )

[node name="Mesh" type="Spatial" parent="Scene/Portals/PortalPair1/PortalA/Shape"]

[node name="Inside" type="MeshInstance" parent="Scene/Portals/PortalPair1/PortalA/Shape/Mesh"]
material_override = SubResource( 9 )
mesh = SubResource( 10 )
material/0 = null

[node name="Outside" type="MeshInstance" parent="Scene/Portals/PortalPair1/PortalA/Shape/Mesh"]
material_override = SubResource( 9 )
mesh = SubResource( 11 )
material/0 = null

[node name="InsideFloor" type="MeshInstance" parent="Scene/Portals/PortalPair1/PortalA/Shape/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.999, 0 )
material_override = SubResource( 9 )
mesh = SubResource( 12 )
material/0 = null

[node name="Area" type="Area" parent="Scene/Portals/PortalPair1/PortalA/Shape"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Portals/PortalPair1/PortalA/Shape/Area"]
shape = SubResource( 8 )

[node name="PortalB" type="Spatial" parent="Scene/Portals/PortalPair1"]
transform = Transform( -1, 0, -3.25841e-07, 0, 1, 0, 3.25841e-07, 0, -1, 8.3419, 2, -12.9615 )
visible = false

[node name="Viewport" type="Viewport" parent="Scene/Portals/PortalPair1/PortalB"]
keep_3d_linear = true

[node name="Camera" type="Camera" parent="Scene/Portals/PortalPair1/PortalB/Viewport"]
transform = Transform( -0.557333, -0.186473, 0.809079, -0.105783, 0.98246, 0.153564, -0.823523, 6.13572e-09, -0.567283, -10.666, 2.85573, 11.8936 )
current = true

[node name="Shape" type="Spatial" parent="Scene/Portals/PortalPair1/PortalB"]
transform = Transform( 1.5, 0, 0, 0, 2, 0, 0, 0, 0.1, 0, 0, 0 )

[node name="Mesh" type="Spatial" parent="Scene/Portals/PortalPair1/PortalB/Shape"]

[node name="Inside" type="MeshInstance" parent="Scene/Portals/PortalPair1/PortalB/Shape/Mesh"]
material_override = SubResource( 15 )
mesh = SubResource( 16 )
material/0 = null

[node name="Outside" type="MeshInstance" parent="Scene/Portals/PortalPair1/PortalB/Shape/Mesh"]
material_override = SubResource( 15 )
mesh = SubResource( 17 )
material/0 = null

[node name="InsideFloor" type="MeshInstance" parent="Scene/Portals/PortalPair1/PortalB/Shape/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.999, 0 )
material_override = SubResource( 15 )
mesh = SubResource( 18 )
material/0 = null

[node name="Area" type="Area" parent="Scene/Portals/PortalPair1/PortalB/Shape"]

[node name="CollisionShape" type="CollisionShape" parent="Scene/Portals/PortalPair1/PortalB/Shape/Area"]
shape = SubResource( 8 )

[node name="Steve" type="KinematicBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.54277, 4.30587, 20.7111 )
script = ExtResource( 2 )

[node name="Collider" type="CollisionShape" parent="Steve"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0 )
shape = SubResource( 14 )

[node name="Head" type="Spatial" parent="Steve"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.463354, 0 )

[node name="Camera" type="Camera" parent="Steve/Head"]
current = true

[node name="DownRay" type="RayCast" parent="Steve"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.662256, 0 )
enabled = true

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( 0.945, -0.32707, 2.70663e-09, 0.0956204, 0.276276, 0.95631, -0.31278, -0.903713, 0.292355, -31.112, 27.5404, 6.53633 )
